== Testcases

Use script `clean-installation.sh` to create a fresh WordPress installation.

--------------------------------------------------------------------------------

1. Clean installation
Setup a brand new WordPress installation (single site)
Keep debugging console open to monitor network infos and JS errors.
There should be NO PLUGIN ACTIVE at this point (not even WPMU DEV dashboard)

1.1 Install and activate the plugin
  - There should be no warning and no error.
  - A new main menu item will be displayed: "PopUp"
  - The WPMU DEV Dashboard notice should be displayed

1.2 Open PopUp > Settings page
  - Check JS console for errors
  - Change all settings and save
  - Do this multiple times, with different settings (see if stuff is saved)

1.3 Open PopUp > Add New page
  - Check JS console for errors.
  - Check the form if all options are available, esp
    a) the rules that were activated in Settings screen
    b) The styles exist "Minimal/Simple/Cabriolet"
    c) Add image function works
    d) Color-pickers work (custom color)
  - Change some options and see if the input fields are correctly disabled/enabled
  - Scroll down, the "Save PopUp" box must stay visible
  - Switch to 1-column view to see the behavior of the "Save PopUp" box (it changes to toolbar)
  - The meta boxes must be fixed - dragging boxes is not posible

1.4 Save the PopUp
  Create new PopUp
  Don't enter anything and save
  - Check the details if everything is same as before
  - Also check the PopUp list
    a) Status must be Inactive
    b) Conditions must say "Always"

1.5 Create active PopUp
  Create new PopUp
  Enter Heading and Content text, select an image
  Save it with the "Activate" button
  - Check in the List if the PopUp is displayed as active

  Save PopUp box
  - Test the "Save", "Activate" and "Deactivte" buttons in editor
  - Test the "Move to trash" link (the list must be displayed after trashing a PopUp)

1.6 PopUp List
  Create 3 PopUps
  - Try to re-arrange them via drag-and-drop.
  - Test all the bulk actions with 1 and 2 PopUps selected (different messages displayed)
  Move PopUp to trash
  - In trash there is no edit function and no order/status
  - Restore PopUp from trash
  Filter for active/inactive PopUps
  - When filter is active the drag-drop order function is not available

1.7 Test the styles
  Use a PopUp with demo content
  Select a style and then click on the "Preview" button.
  - Make sure the Preview is displayed and looks as expected.
  - Change image alignment (left/right) and preview again
  - Remove the image
  - Remove the heading or subheading
  - Remove the CTA label or link
  - Use custom colors
  - Use custom size
  - Resize the viewport to test responsive layout
  - Toggle rounded corners

  -> Repeat with all available styles

1.8 Test the behavior
  Use a PopUp with demo content
  Open the front page that displays the PopUp and test if it is displayed correctly
  - Delay 0s
  - Delay 5s
  - Delay 1m
  - Scroll 50%
  - Scroll 50px
  - Scroll until element "X"
  - On mouse leave
  - On mouse click on "X" (once and repeated)

  Modal background
  - Test the click-background option

  Hide-forever link
  - Display hide forever
  - Close acts as hide forever
  Hide forever creates a cookie with the prefix "po_h-"
  - Check the livespan of this cookie to validate the expire delay

1.11 Loading methods
  In settings screen there are 4 loading methods.
  Each method must work out-of-the box on the front end
  - Confirm that a PopUp that is displayed in the front end is displayed same using all 4 methods

1.10 Conditions
  Activate all conditions in the Settings screen
  - Activate the first condition in an active PopUp
  - Save and validate on front end that the condition works
  - Repeat this with all the other conditions (only have 1 condition active at a time)

  Special attention:
  - Post-type/Category conditions must be tested with ALL 4 loading methods!!

--------------------------------------------------------------------------------

2. Upgrade from 4.5 to 4.6 version
Install the old plugin via the normal WPMU Dev dashboard
Activate all Add-Ons
Create some PopUps
At least one PopUp should use ALL available conditions
Then replace the wp-contents/plugins/popover folder with the new version

2.1 Directly after replacing the directory open the PopUp list
  - All your PopUps must be visible, same as before.
  - Open the PopUp editor and check the details.
    a) Especially check the conditions

2.2 Check the Settings
  - Confirm in settings page that all rules/conditions are checked
  - The loading method must match

  --> Test the Upgrade with all 4 loading methods:
      Revert the Installation and upgrade again!

--------------------------------------------------------------------------------

3. Multisite Installation
Create a new, empty WordPress Multisite installation
Install the latest plugin and NETWORK ACTIVATE it

3.1 Check on a single installation
  Switch to a Site dashboard
  - Confirm the "PopUp" menu item is displayed

  Create 1-2 PopUps here
  - Make sure data is saved correctly

  Switch to a different Site
  - PopUps from first Site must not be displayed here
  - Create some new PopUps
  - Again check the List on the first Site. Data must be 100% separate!

3.2 PO_GLOBAL Option
  In wp-config add `define( 'PO_GLOBAL', true );`
  - The PopUp menu items must be on the Site Admin dashboard
  - On a Site dashboard there must be NO PopUp menu item anymore