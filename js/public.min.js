!function(){var t=function(t){var e=this,o=jQuery(document),a=jQuery(window),i=null,p=null,d=null,s=null,n=null,r=null,u=null,c=null;return this.data={},this.have_popup=!1,this.ajax_data={},this.close_forever=function(){var o=e.data.expiry||365;return e.close_popup(),t.preview?!1:(e.set_cookie("po_h",1,o),!1)},this.close_popup=function(){return jQuery("html").removeClass("has-popup"),e.data.display_data.click_multi?(c.hide(),i.hide()):(c.remove(),i.remove(),e.have_popup=!1),o.trigger("popup-closed"),o.trigger("popover-closed"),e.have_popup||e.next_popup(),!1},this.background_clicked=function(t){var o=jQuery(t.target);if(o.hasClass("wdpu-background")){if(!e.data.overlay_close)return;e.close_popup()}},this.move_popup=function(){var t,o,i,d=0,s=0;e.data.custom_size&&(e.data.height&&!isNaN(e.data.height)&&(r.data("reduce-height")&&(i=jQuery(r.data("reduce-height")),s=i.outerHeight()),o=e.data.height-s,100>o&&(o=100),r.height(o)),e.data.width&&!isNaN(e.data.width)&&(r.data("reduce-width")&&(i=jQuery(r.data("reduce-width")),d=i.outerWidth()),t=e.data.width-d,100>t&&(t=100),r.width(t))),window.setTimeout(function(){if(!n.hasClass("no-move")){var t=a.width(),o=a.height(),i=p.outerWidth(),d=p.outerHeight(),s=(t-i)/2,r=(o-d)/2;i+30>t||0>s?isNaN(e.data._switch_width)&&(e.data._switch_width=t,n.addClass("small-width").css({left:""})):e.data._switch_width<t?(e.data._switch_width=void 0,n.removeClass("small-width"),n.css({left:s})):n.css({left:s}),10>r&&(r=10),n.css({top:r})}if(u.length){var c=u.width(),l=u.parent().width();c>l?(offset_x=(l-c)/2,u.css({"margin-left":offset_x})):u.css({"margin-left":0})}},20)},this.reject=function(){e.have_popup=!1,e.data={}},this.maybe_show_popup=function(){if(e.fetch_dom(),i.css({opacity:0,"z-index":-1,position:"absolute",left:-1e3,width:100,right:"auto",top:-1e3,height:100,bottom:"auto"}).show(),o.trigger("popup-init",[e,e.data]),e.have_popup)switch(e.data.display){case"scroll":a.on("scroll",e.show_at_position);break;case"anchor":a.on("scroll",e.show_at_element);break;case"delay":var t=1e3*e.data.display_data.delay;"m"==e.data.display_data.delay_type&&(t*=60),window.setTimeout(function(){e.show()},t);break;default:setTimeout(function(){"function"==typeof e.custom_handler&&e.custom_handler(e)},20)}else e.next_popup()},this.show_at_position=function(){var t,i,p=jQuery(this),d=p.scrollTop();switch(e.data.display_data.scroll_type){case"px":d>=e.data.display_data.scroll&&(a.off("scroll",e.show_at_position),e.show());break;case"%":default:t=o.height()-a.height(),i=100*d/t,i>=e.data.display_data.scroll&&(a.off("scroll",e.show_at_position),e.show())}},this.show_at_element=function(){var t=jQuery(e.data.display_data.anchor),o=a.scrollTop(),i=o+a.height(),p=t.offset().top,d=i-p;d>10&&(a.off("scroll",e.show_at_element),e.show())},this.show=function(){c.on("click",e.background_clicked),o.on("popup-closed",e.reinit),a.off("resize.popup").on("resize.popup",function(){e.move_popup(e.data)}),i.show().removeAttr("style"),c.show(),e.move_popup(e.data),jQuery("html").addClass("has-popup"),s.off("click",e.close_forever).on("click",e.close_forever),e.data&&e.data.close_hide?d.off("click",e.close_forever).on("click",e.close_forever):d.off("click",e.close_popup).on("click",e.close_popup),p.hover(function(){jQuery(".claimbutton").removeClass("hide")},function(){jQuery(".claimbutton").addClass("hide")}),o.trigger("popup-displayed",[e.data,e]),o.trigger("popover-displayed",[e.data,e])},this.fetch_dom=function(){i=jQuery("#"+e.data.html_id),r=i.find(".resize"),n=i.find(".move"),p=i.find(".wdpu-msg"),d=i.find(".wdpu-close"),s=i.find(".wdpu-hide-forever"),u=i.find(".wdpu-image > img"),i.hasClass("wdpu-background")?c=i:(c=i.find(".wdpu-background"),c.length||(c=jQuery(".wdpu-background"))),n.length||(n=i),r.length||(r=i)},this.prepare_dom=function(){return""===e.data.html?!1:(jQuery('<style type="text/css">'+e.data.styles+"</style>").appendTo("head"),jQuery(e.data.html).appendTo("body"),e.fetch_dom(),i.hide(),c.hide(),e.maybe_show_popup(),void 0)},this.load_popup=function(a,i){var p,d,s=0,n=window.location,r=document.referrer;e.have_popup=!1;var u=function(t){e.data=t,t&&(e.have_popup=!0,e.exec_scripts(),e.prepare_dom())};return"undefined"!=typeof force_popover&&(s=force_popover.toString()),"undefined"!=typeof a&&(s=a.toString()),t.ajax_data=t.ajax_data||{},d=jQuery.extend({},t.ajax_data),d.action="inc_popup",d["do"]=t["do"],d.thefrom=n.toString(),d.thereferrer=r.toString(),s&&(d.po_id=s),i&&(d.data=i),t.preview&&(d.preview=!0),p={url:t.ajaxurl,dataType:"jsonp",jsonpCallback:"po_data",data:d,success:function(t){u(t)},complete:function(){o.trigger("popup-load-done",[e.data,e])}},jQuery.ajax(p)},this.next_popup=function(){console.log("try to fetch next popup...")},this.init=function(){t.popup?(e.have_popup=!0,e.data=t.popup,e.exec_scripts(),e.maybe_show_popup()):(e.have_popup=!1,e.load_popup())},this.reinit=function(){"click"==e.data.display&&e.data.display_data.click_multi&&e.maybe_show_popup()},this.exec_scripts=function(){if(void 0!==e.data.script){var t=new Function("me",e.data.script);t(e)}},this.get_cookie=function(t){var o,a,i,p=document.cookie.split(";");for(i=e.data&&e.data.popup_id?t+"-"+e.data.popup_id+"=":t+"=",o=0;o<p.length;o+=1){for(a=p[o];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(i))return a.substring(i.length,a.length)}return null},this.set_cookie=function(o,a,i){var p,d,s;t.preview||(isNaN(i)?d="":(p=new Date,p.setTime(p.getTime()+24*i*60*60*1e3),d="; expires="+p.toGMTString()),s=e.data&&e.data.popup_id?o+"-"+e.data.popup_id:o,document.cookie=s+"="+a+d+"; path=/")},{init:e.init,load:e.load_popup,extend:e}};jQuery(function(){window.inc_popup=new t(_popup_data),_popup_data.noinit||_popup_data.preview||inc_popup.init()})}();