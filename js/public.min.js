!function(){var o=function(o){var t=this,e=jQuery(document),a=jQuery(window),p=jQuery("#darkbackground"),i=null,n=null,d=null,r=null,s=null,u=null;return this.data={},this.have_popup=!1,this.close_forever=function(){var e=t.data.expiry||365;return t.close_popup(),o.preview?!1:(t.set_cookie("po_h",1,e),!1)},this.close_popup=function(){return t.data.display_data.click_multi?(p.hide(),i.hide()):(p.remove(),i.remove(),t.have_popup=!1),e.trigger("popup-closed"),e.trigger("popover-closed"),t.have_popup||t.next_popup(),!1},this.background_clicked=function(o){var e=jQuery(o.target);if(e.hasClass("wdpu-background")){if(!t.data.overlay_close)return;t.close_popup()}},this.move_popup=function(){t.data.custom_size&&s.width(t.data.width).height(t.data.height),s.hasClass("no-move")||window.setTimeout(function(){s.css({top:(a.height()-n.height())/2,left:(a.width()-n.width())/2})},20)},this.reject=function(){t.have_popup=!1,t.data={}},this.maybe_show_popup=function(){if(t.fetch_dom(),i.css({opacity:0,"z-index":-1,position:"absolute",left:-1e3,width:100,right:"auto",top:-1e3,height:100,bottom:"auto"}).show(),e.trigger("popup-init",[t,t.data]),t.have_popup)switch(t.data.display){case"scroll":a.on("scroll",t.show_at_position);break;case"anchor":a.on("scroll",t.show_at_element);break;case"delay":var o=1e3*t.data.display_data.delay;"m"==t.data.display_data.delay_type&&(o*=60),window.setTimeout(function(){t.show()},o);break;default:setTimeout(function(){"function"==typeof t.custom_handler&&t.custom_handler(t)},20)}else t.next_popup()},this.show_at_position=function(){var o,p,i=jQuery(this),n=i.scrollTop();switch(t.data.display_data.scroll_type){case"px":n>=t.data.display_data.scroll&&(a.off("scroll",t.show_at_position),t.show());break;case"%":default:o=e.height()-a.height(),p=100*n/o,p>=t.data.display_data.scroll&&(a.off("scroll",t.show_at_position),t.show())}},this.show_at_element=function(){var o=jQuery(t.data.display_data.anchor),e=a.scrollTop(),p=e+a.height(),i=o.offset().top,n=p-i;n>10&&(a.off("scroll",t.show_at_element),t.show())},this.show=function(){t.move_popup(t.data),u.on("click",t.background_clicked),e.on("popup-closed",t.reinit),a.off("resize.popup").on("resize.popup",function(){t.move_popup(t.data)}),i.show().removeAttr("style"),p.show(),r.off("click",t.close_forever).on("click",t.close_forever),t.data&&t.data.close_hide?d.off("click",t.close_forever).on("click",t.close_forever):d.off("click",t.close_popup).on("click",t.close_popup),n.hover(function(){jQuery(".claimbutton").removeClass("hide")},function(){jQuery(".claimbutton").addClass("hide")}),e.trigger("popup-displayed",[t.data,t]),e.trigger("popover-displayed",[t.data,t])},this.fetch_dom=function(){i=jQuery("#"+t.data.html_id),s=i.find(".resize"),n=i.find(".wdpu-msg"),d=i.find(".wdpu-close"),r=i.find(".wdpu-hide-forever"),i.hasClass("wdpu-background")?u=i:(u=i.find(".wdpu-background"),!u.length&&p.length&&(u=p)),s.length||(s=i)},this.prepare_dom=function(){return""===t.data.html?!1:(jQuery('<style type="text/css">'+t.data.styles+"</style>").appendTo("head"),jQuery(t.data.html).appendTo("body"),t.fetch_dom(),i.hide(),p.hide(),t.maybe_show_popup(),void 0)},this.load_popup=function(a,p){var i,n,d=0,r=window.location,s=document.referrer;t.have_popup=!1;var u=function(o){t.data=o,o&&(t.have_popup=!0,t.prepare_dom())};return"undefined"!=typeof force_popover&&(d=force_popover.toString()),"undefined"!=typeof a&&(d=a.toString()),n={action:"inc_popup","do":o["do"],thefrom:r.toString(),thereferrer:s.toString()},d&&(n.po_id=d),p&&(n.data=p),o.preview&&(n.preview=!0),i={url:o.ajaxurl,dataType:"jsonp",jsonpCallback:"po_data",data:n,success:function(o){u(o)},complete:function(){e.trigger("popup-load-done",[t.data,t])}},jQuery.ajax(i)},this.next_popup=function(){console.log("try to fetch next popup...")},this.init=function(){o.popup?(t.have_popup=!0,t.data=o.popup,t.maybe_show_popup()):(t.have_popup=!1,t.load_popup())},this.reinit=function(){t.data.display_data.click_multi&&t.maybe_show_popup()},this.get_cookie=function(o){var e,a,p,i=document.cookie.split(";");for(p=t.data&&t.data.popup_id?o+"-"+t.data.popup_id+"=":o+"=",e=0;e<i.length;e+=1){for(a=i[e];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(p))return a.substring(p.length,a.length)}return null},this.set_cookie=function(e,a,p){var i,n,d;o.preview||(isNaN(p)?n="":(i=new Date,i.setTime(i.getTime()+24*p*60*60*1e3),n="; expires="+i.toGMTString()),d=t.data&&t.data.popup_id?e+"-"+t.data.popup_id:e,document.cookie=d+"="+a+n+"; path=/")},{init:t.init,load:t.load_popup,extend:t}};jQuery(function(){window.inc_popup=new o(_popup_data),_popup_data.noinit||_popup_data.preview||inc_popup.init()})}();