!function(){var t=function(t){var o=this,e=jQuery(document),a=jQuery(window),p=jQuery("#darkbackground"),i=null,n=null,s=null,d=null,r=null,u=null,l=null;return this.data={},this.have_popup=!1,this.close_forever=function(){var e=o.data.expiry||365;return o.close_popup(),t.preview?!1:(o.set_cookie("po_h",1,e),!1)},this.close_popup=function(){return jQuery("html").removeClass("has-popup"),o.data.display_data.click_multi?(p.hide(),i.hide()):(p.remove(),i.remove(),o.have_popup=!1),e.trigger("popup-closed"),e.trigger("popover-closed"),o.have_popup||o.next_popup(),!1},this.background_clicked=function(t){var e=jQuery(t.target);if(e.hasClass("wdpu-background")){if(!o.data.overlay_close)return;o.close_popup()}},this.move_popup=function(){o.data.custom_size&&u.width(o.data.width).height(o.data.height),r.hasClass("no-move")||window.setTimeout(function(){var t=a.width(),e=a.height(),p=n.outerWidth(),i=n.outerHeight(),s=(t-p)/2,d=(e-i)/2;p+30>t||0>s?isNaN(o.data._switch_width)&&(o.data._switch_width=t,r.addClass("small-width").css({left:""})):o.data._switch_width<t?(o.data._switch_width=void 0,r.removeClass("small-width"),r.css({left:s})):r.css({left:s}),10>d&&(d=10),r.css({top:d})},20)},this.reject=function(){o.have_popup=!1,o.data={}},this.maybe_show_popup=function(){if(o.fetch_dom(),i.css({opacity:0,"z-index":-1,position:"absolute",left:-1e3,width:100,right:"auto",top:-1e3,height:100,bottom:"auto"}).show(),e.trigger("popup-init",[o,o.data]),o.have_popup)switch(o.data.display){case"scroll":a.on("scroll",o.show_at_position);break;case"anchor":a.on("scroll",o.show_at_element);break;case"delay":var t=1e3*o.data.display_data.delay;"m"==o.data.display_data.delay_type&&(t*=60),window.setTimeout(function(){o.show()},t);break;default:setTimeout(function(){"function"==typeof o.custom_handler&&o.custom_handler(o)},20)}else o.next_popup()},this.show_at_position=function(){var t,p,i=jQuery(this),n=i.scrollTop();switch(o.data.display_data.scroll_type){case"px":n>=o.data.display_data.scroll&&(a.off("scroll",o.show_at_position),o.show());break;case"%":default:t=e.height()-a.height(),p=100*n/t,p>=o.data.display_data.scroll&&(a.off("scroll",o.show_at_position),o.show())}},this.show_at_element=function(){var t=jQuery(o.data.display_data.anchor),e=a.scrollTop(),p=e+a.height(),i=t.offset().top,n=p-i;n>10&&(a.off("scroll",o.show_at_element),o.show())},this.show=function(){l.on("click",o.background_clicked),e.on("popup-closed",o.reinit),a.off("resize.popup").on("resize.popup",function(){o.move_popup(o.data)}),i.show().removeAttr("style"),p.show(),o.move_popup(o.data),jQuery("html").addClass("has-popup"),d.off("click",o.close_forever).on("click",o.close_forever),o.data&&o.data.close_hide?s.off("click",o.close_forever).on("click",o.close_forever):s.off("click",o.close_popup).on("click",o.close_popup),n.hover(function(){jQuery(".claimbutton").removeClass("hide")},function(){jQuery(".claimbutton").addClass("hide")}),e.trigger("popup-displayed",[o.data,o]),e.trigger("popover-displayed",[o.data,o])},this.fetch_dom=function(){i=jQuery("#"+o.data.html_id),u=i.find(".resize"),r=i.find(".move"),n=i.find(".wdpu-msg"),s=i.find(".wdpu-close"),d=i.find(".wdpu-hide-forever"),i.hasClass("wdpu-background")?l=i:(l=i.find(".wdpu-background"),!l.length&&p.length&&(l=p)),r.length||(r=i),u.length||(u=i)},this.prepare_dom=function(){return""===o.data.html?!1:(jQuery('<style type="text/css">'+o.data.styles+"</style>").appendTo("head"),jQuery(o.data.html).appendTo("body"),o.fetch_dom(),i.hide(),p.hide(),o.maybe_show_popup(),void 0)},this.load_popup=function(a,p){var i,n,s=0,d=window.location,r=document.referrer;o.have_popup=!1;var u=function(t){o.data=t,t&&(o.have_popup=!0,o.prepare_dom())};return"undefined"!=typeof force_popover&&(s=force_popover.toString()),"undefined"!=typeof a&&(s=a.toString()),n={action:"inc_popup","do":t["do"],thefrom:d.toString(),thereferrer:r.toString()},s&&(n.po_id=s),p&&(n.data=p),t.preview&&(n.preview=!0),i={url:t.ajaxurl,dataType:"jsonp",jsonpCallback:"po_data",data:n,success:function(t){u(t)},complete:function(){e.trigger("popup-load-done",[o.data,o])}},jQuery.ajax(i)},this.next_popup=function(){console.log("try to fetch next popup...")},this.init=function(){t.popup?(o.have_popup=!0,o.data=t.popup,o.maybe_show_popup()):(o.have_popup=!1,o.load_popup())},this.reinit=function(){o.data.display_data.click_multi&&o.maybe_show_popup()},this.get_cookie=function(t){var e,a,p,i=document.cookie.split(";");for(p=o.data&&o.data.popup_id?t+"-"+o.data.popup_id+"=":t+"=",e=0;e<i.length;e+=1){for(a=i[e];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(p))return a.substring(p.length,a.length)}return null},this.set_cookie=function(e,a,p){var i,n,s;t.preview||(isNaN(p)?n="":(i=new Date,i.setTime(i.getTime()+24*p*60*60*1e3),n="; expires="+i.toGMTString()),s=o.data&&o.data.popup_id?e+"-"+o.data.popup_id:e,document.cookie=s+"="+a+n+"; path=/")},{init:o.init,load:o.load_popup,extend:o}};jQuery(function(){window.inc_popup=new t(_popup_data),_popup_data.noinit||_popup_data.preview||inc_popup.init()})}();