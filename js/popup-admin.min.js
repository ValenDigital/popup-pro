jQuery(function(){function disable_metabox_dragging(){var boxes=jQuery(".meta-box-sortables"),handles=jQuery(".postbox .hndle");boxes.length&&(boxes.sortable({disabled:!0}),handles.css("cursor","pointer"))}function scrolling_submitdiv(){var top_offset,padding=20,submitdiv=jQuery("#submitdiv"),postbody=jQuery("#post-body"),body=jQuery("body"),padding=20;if(submitdiv.length){top_offset=submitdiv.position().top;var small_make_sticky=function(){body.hasClass("sticky-submit")||(body.addClass("sticky-submit"),submitdiv.css({marginTop:0}),submitdiv.find(".sticky-actions").show(),submitdiv.find(".non-sticky").hide())},small_remove_sticky=function(){body.hasClass("sticky-submit")&&(body.removeClass("sticky-submit"),submitdiv.find(".sticky-actions").hide(),submitdiv.find(".non-sticky").show())};jQuery(window).resize(function(){var is_small=jQuery(window).width()<=850;is_small?body.hasClass("po-small")||body.addClass("po-small"):body.hasClass("po-small")&&(body.removeClass("po-small"),small_remove_sticky())}).scroll(function(){if(postbody.hasClass("columns-1")||body.hasClass("po-small")){var scroll_top=jQuery(window).scrollTop()-top_offset;scroll_top>0?small_make_sticky():small_remove_sticky()}else{var scroll_top=jQuery(window).scrollTop()-top_offset+padding;scroll_top>0?submitdiv.css({marginTop:scroll_top}):submitdiv.css({marginTop:0})}}),setTimeout(function(){jQuery(window).trigger("scroll")},100)}}function init_colorpicker(){var inp=jQuery(".colorpicker");if(inp.length&&"function"==typeof inp.wpColorPicker){var maybe_hide_picker=function(ev){var el=jQuery(ev.target),cp=el.closest(".wp-picker-container"),me=cp.find(".colorpicker"),do_hide=jQuery(".colorpicker");cp.length&&(do_hide=do_hide.not(me)),do_hide.each(function(){var picker=jQuery(this),wrap=picker.closest(".wp-picker-container");picker.iris("hide"),picker.hide(),wrap.find(".wp-picker-clear").addClass("hidden"),wrap.find(".wp-picker-open").removeClass("wp-picker-open")})};inp.wpColorPicker(),jQuery(document).on("mousedown",maybe_hide_picker),jQuery(document).on("click",maybe_hide_picker),jQuery(document).on("mouseup",maybe_hide_picker)}}function init_edit_controls(){var chk_colors=jQuery("#po-custom-colors"),chk_size=jQuery("#po-custom-size"),opt_display=jQuery("[name=po_display]"),chk_can_hide=jQuery("#po-can-hide"),chk_close_hides=jQuery("#po-close-hides");if(chk_colors.length){var toggle_section=function(){var me=jQuery(this),sel=me.data("toggle"),sect=jQuery(sel),group_or=me.data("or"),group_and=me.data("and"),is_active=!1;if(group_or){var group=jQuery(group_or);is_active=group.filter(":checked").length>0}else if(group_and){var group=jQuery(group_and);is_active=group.length==group.filter(":checked").length}else is_active=me.prop("checked");is_active?(sect.removeClass("inactive"),sect.find("input,select,textarea,a").prop("readonly",!1).removeClass("disabled")):(sect.addClass("inactive"),sect.find("input,select,textarea,a").prop("readonly",!0).addClass("disabled")),sect.addClass("inactive-anim")},toggle_section_group=function(){var me=jQuery(this),name=me.attr("name"),group=jQuery('[name="'+name+'"]');group.each(function(){toggle_section.call(this)})},create_sliders=function(){jQuery(".slider").each(function(){var me=jQuery(this),wrap=me.closest(".slider-wrap"),inp_base=me.data("input"),inp_min=wrap.find(inp_base+"min"),inp_max=wrap.find(inp_base+"max"),min_input=wrap.find(".slider-min-input"),min_ignore=wrap.find(".slider-min-ignore"),max_input=wrap.find(".slider-max-input"),max_ignore=wrap.find(".slider-max-ignore"),min=me.data("min"),max=me.data("max");isNaN(min)&&(min=0),isNaN(max)&&(max=9999),inp_min.prop("readonly",!0),inp_max.prop("readonly",!0);var update_fields=function(val1,val2){inp_min.val(val1),inp_max.val(val2),val1==min?(min_input.hide(),min_ignore.show()):(min_input.show(),min_ignore.hide()),val2==max?(max_input.hide(),max_ignore.show()):(max_input.show(),max_ignore.hide())};me.slider({range:!0,min:min,max:max,values:[inp_min.val(),inp_max.val()],slide:function(event,ui){update_fields(ui.values[0],ui.values[1])}}),update_fields(inp_min.val(),inp_max.val())})};chk_colors.click(toggle_section),chk_size.click(toggle_section),chk_can_hide.click(toggle_section),chk_close_hides.click(toggle_section),opt_display.click(toggle_section_group),toggle_section.call(chk_colors),toggle_section.call(chk_size),toggle_section.call(chk_can_hide),toggle_section.call(chk_close_hides),opt_display.each(function(){toggle_section.call(jQuery(this))}),create_sliders()}}function init_rules(){var all_rules=jQuery("#meta-rules .all-rules"),active_rules=jQuery("#meta-rules .active-rules");if(all_rules.length){var toggle_checkbox=function(ev){var me=jQuery(ev.target),chk=me.find("input.wpmui-toggle-checkbox");if(!me.closest(".wpmui-toggle").length)return me.hasClass("inactive")?!1:(chk.trigger("click"),void 0)},toggle_rule=function(){var me=jQuery(this),rule=me.closest(".rule"),sel=me.data("form"),form=active_rules.find(sel),active=me.prop("checked");active?(rule.removeClass("off").addClass("on"),form.removeClass("off").addClass("on open")):(rule.removeClass("on").addClass("off"),form.removeClass("on").addClass("off")),exclude_rules(me,active)},exclude_rules=function(checkbox,active){var ind,excl1,excl2,excl=checkbox.data("exclude"),keys=excl?excl.split(","):[];for(ind=keys.length-1;ind>=0;ind-=1)excl1=all_rules.find(".rule-"+keys[ind]),excl2=active_rules.find("#po-rule-"+keys[ind]),excl1.hasClass("on")||(excl1.prop("disabled",active),active?(excl1.addClass("inactive off").removeClass("on"),excl2.addClass("off").removeClass("on")):excl1.removeClass("inactive off"))},toggle_form=function(){var me=jQuery(this),form=me.closest(".rule");form.toggleClass("open")};all_rules.find("input.wpmui-toggle-checkbox").click(toggle_rule),all_rules.find(".rule").click(toggle_checkbox),active_rules.on("click",".rule-title,.rule-toggle",toggle_form),all_rules.find(".rule.on input.wpmui-toggle-checkbox").each(function(){exclude_rules(jQuery(this),!0)}),jQuery(".init-loading").removeClass("wpmui-loading")}}function init_image(){var file_frame,box=jQuery(".content-image"),btn=box.find(".add_image"),dropzone=box.find(".featured-img"),reset=box.find(".reset"),inp=box.find(".po-image"),img_preview=box.find(".img-preview"),img_label=box.find(".lbl-empty"),img_pos=box.find(".img-pos"),use_image=function(url){inp.val(url),img_preview.attr("src",url).show(),img_label.hide(),img_pos.show(),dropzone.addClass("has-image")},reset_image=function(){inp.val(""),img_preview.attr("src","").hide(),img_label.show(),img_pos.hide(),dropzone.removeClass("has-image")},select_clicked=function(ev){return ev.preventDefault(),file_frame?(file_frame.open(),void 0):(file_frame=wp.media.frames.file_frame=wp.media({title:btn.attr("data-title"),button:{text:btn.attr("data-button")},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),use_image(attachment.url)}),file_frame.open(),void 0)},select_pos=function(){var me=jQuery(this);img_pos.find(".option").removeClass("selected"),me.addClass("selected")};btn.on("click",select_clicked),reset.on("click",reset_image),img_pos.on("click",".option",select_pos)}function bulk_actions(){var key,ba1=jQuery('select[name="action"] '),ba2=jQuery('select[name="action2"] ');if(ba1.length&&"object"==typeof window.po_bulk)for(key in po_bulk)jQuery("<option>").val(key).text(po_bulk[key]).appendTo(ba1).clone().appendTo(ba2)}function sortable_list(){var table=jQuery("table.posts");if(tbody=table.find("#the-list"),tbody.length){var ajax_done=function(resp,okay){if(table.removeClass("wpmui-loading"),okay)for(var id in resp)resp.hasOwnProperty(id)&&tbody.find("#post-"+id+" .the-pos").text(resp[id])},save_order=function(){var i,rows=tbody.find("tr"),order=[];for(i=0;i<rows.length;i+=1)order.push(jQuery(rows[i]).attr("id"));table.addClass("wpmui-loading"),wpmUi.ajax(null,"po-ajax").data({"do":"order",order:order}).ondone(ajax_done).load_json()};tbody.sortable({placeholder:"ui-sortable-placeholder",axis:"y",handle:".column-po_order",helper:"clone",opacity:.75,update:save_order}),tbody.disableSelection()}}function init_preview(){var doc=jQuery(document);body=jQuery("#wpcontent");var handle_list_click=function(ev){var me=jQuery(this),po_id=me.data("id");return ev.preventDefault(),void 0===window.inc_popup?!1:(body.addClass("wpmui-loading"),inc_popup.load(po_id),!1)},handle_editor_click=function(ev){var form=(jQuery(this),jQuery("#post")),ajax=wpmUi.ajax();return ev.preventDefault(),void 0===window.inc_popup?!1:(data=ajax.extract_data(form),body.addClass("wpmui-loading"),inc_popup.load(0,data),!1)},show_popup=function(ev,popup){body.removeClass("wpmui-loading"),popup.init()};doc.on("click",".posts .po-preview",handle_list_click),doc.on("click","#post .preview",handle_editor_click),doc.on("popup-initialized",show_popup)}jQuery("body.post-type-inc_popup").length&&(jQuery("body.post-php").length||jQuery("body.post-new-php").length?(disable_metabox_dragging(),scrolling_submitdiv(),init_colorpicker(),init_edit_controls(),init_rules(),init_preview(),init_image(),wpmUi.upgrade_multiselect()):jQuery("body.edit-php").length&&(sortable_list(),bulk_actions(),init_preview()))});
//# sourceMappingURL=popup-admin.min.js.map